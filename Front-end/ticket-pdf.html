<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ticket-pdf</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Gupter:wght@400;500;700&family=Lora:ital,wght@0,400..700;1,400..700&family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Oswald:wght@200..700&family=Quicksand:wght@300..700&family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Rubik:ital,wght@0,300..900;1,300..900&family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="pdf-styles.css">

    <style type="text/css">

    </style>

    <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

</head>
<body>
    <div class="header">
        <div><img src="Images/logo.png" alt="Startlight Cinema"></div>
        <div class="search-container">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Search Movies..." class="search-input">
        </div>
        <div><img src="Images/logo.png" alt="Startlight Cinema"></div>
    </div>

    <div class="pdf-home-main">
        <div class="pdf-print" id="content">
            <div class="pdf-header">
                <h1 style="color: orange">Thank you for your purchase!</h1>
            </div>
            <div class="pdf-detail">
                <div class="pdf-booking-details">
                    <div class="pdf-booking-details-content">
                        <p id="pdf-movieTitle"></p>
                        Star Light 3D Cinema: Kiribathgoda <br>
                        (STARLIGHT CINEMA), <br>
                        Sri Lanka. <br> <br>
                        <span id="pdf-movieTimeAndDate"></span> <br>
                        Quantity : <span id="pdf-quantity"></span> <br>
                        Seat Numbers : <span id="pdf-seat-numbers"></span> <br> <br>
                        <hr>
                    </div>
                    <div class="pdf-amount">
                        <div>AMOUNT PAID</div>
                        <div>LKR. <span id="total-fee"></span>.00</div>
                    </div>
                </div>
            
                <div class="pdf-qr">
                    <div class="qr">
                        <img id="qr-code-img" alt="QR Code" />
                    </div>
                    <div class="qr-text">
                        Booking ID <br>
                        <span id="pdf-bookingId"></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="pdf-footer">
            <button id="home-page-btn">Home Page</button> <br>
            <button id="cmd">Print PDF</button>
        </div>
    </div>

    <div class="footer">
        <div class="footer-container">
            <div class="item1 item">
                <h3>GENERAL</h3>
                <a href="">About Us</a> | <a href="">FAQ'S</a> | <a href="">Feedback</a> | <br>
                <a href="">Privancy Policy</a> | <a href="">Terms & Conditions</a> | <br>
            </div>
            <div class="itme2 item">
                <h3>POPULAR MOVIES BY LANGUAGE</h3>
                <a href="">Latest Sinhala Movies</a> <br>
                <a href="">Latest English Movies</a> <br>
                <a href="">Latest Hindi Movies</a> <br>
                <a href="">Latest Tamil Movies</a> <br>
            </div>
            <div class="item3 item">
                <h3>MOVIES BY GENRE</h3>
                <a href="">Best Action Movies</a> | <a href="">Best Romantic Movies</a> | <br>
                <a href="">Best Comedy Movies</a> | <a href="">Best Adventure Movies</a> | <br>
                <a href="">Best Biography Movies</a> | <a href="">Best Crime Movies</a> | <br>
                <a href="">Best Drama Movies</a> | <a href="">Best Family Movies</a> | <br>
                <a href="">Best Fantasy Movies</a> | <a href="">Best History Movies</a> | <br>
                <a href="">Best Musical Movies</a> | <a href="">Best Mystery Movies</a> | <br>
                <a href="">Best Thriller Movies</a> <br>
            </div>
            <div class="item4 item">
                <h3>SOCIAL MEDIA</h3>
                <div class="image-sm">
                    <a href=""><img id="instagram" src="Images/instagram.png" alt=""></a>
                    <a href=""><img src="Images/whatsapp.png" alt=""></a>
                    <a href=""><img src="Images/youtube.png" alt=""></a>
                </div>
                <div class="image-sm">
                    <a href=""><img src="Images/linkedin.png" alt=""></a>
                    <a href=""><img src="Images/github.png" alt=""></a>
                    <a href=""><img src="Images/twitter.png" alt=""></a>
                </div>
            </div>
        </div>
        <div class="credits">
            <hr>
            Copyright Â© 2024 A.Dasun Navindu Dewnith Nandasiri All Rights Reserved. <br>
            The content and images used on this site are copyright protected and copyrights vests with the respective
            owners. The
            usage of the content and images on this website is intended to promote the works and no endorsement of the
            artist shall <br>
            be implied. Unauthorized use is prohibited and punishable by law. <br>
        </div>
    </div>
    

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            window.history.pushState(null, '', window.location.href);

            window.addEventListener('popstate', function () {
                alert('Returning to the previous page is not allowed.');
                window.location.href = 'movies.html';
            });

            function getQueryParam(name) {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(name);
            }

            const title = getQueryParam('title');
            const timeSlot = getQueryParam('timeSlot');
            const movieDate = getQueryParam('movieDate');
            const numOfSeats = getQueryParam('numOfSeats');
            const bookingId = getQueryParam('bookingId');
            const totalFee = getQueryParam('totalFee');

            document.getElementById('pdf-movieTitle').textContent = `Movie: ${title}`;
            document.getElementById('pdf-movieTimeAndDate').textContent = `Time: ${timeSlot} | Date: ${movieDate}`;
            document.getElementById('pdf-quantity').textContent = numOfSeats;
            document.getElementById('pdf-seat-numbers').textContent = "Seats: " + Array.from({ length: numOfSeats }).map((_, i) => String.fromCharCode(65 + i) + (i + 1)).join(', ');
            document.getElementById('total-fee').textContent = totalFee;
            document.getElementById('pdf-bookingId').textContent = bookingId;

            const qrCodeImg = document.getElementById('qr-code-img');

            QRCode.toDataURL(bookingId, { width: 200, height: 200 }, function (error, url) {
                if (error) {
                    console.error('Error generating QR code:', error);
                } else {
                    qrCodeImg.src = url;
                }
            });

            const homeButton = document.getElementById('home-page-btn');

            homeButton.addEventListener('click', function () {
                window.location.href = 'movies.html';
            });

            document.getElementById('cmd').addEventListener('click', function () {
                const { jsPDF } = window.jspdf;
                var doc = new jsPDF();

                html2canvas(document.getElementById('content')).then(function (canvas) {
                    var imgData = canvas.toDataURL('image/png');

                    doc.addImage(imgData, 'PNG', 10, 10, 180, 160);

                    doc.save('generated-file.pdf');
                });
            });
        });
    </script>
</body>
</html>