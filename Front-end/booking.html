<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking-html</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="header">
        <div><img src="Images/logo.png" alt="Startlight Cinema"></div>
        <div class="search-container">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Search Movies..." class="search-input">
        </div>
        <div><img src="Images/logo.png" alt="Startlight Cinema"></div>
    </div>

    <div class="seat-body">
        <div class="cinema-background-area">
            <h1 style="color: orange;">Select Your Seats</h1>
            <div class="seats-grid">
                <!-- Row A -->
                <button class="seat" id="seatA1">A1</button>
                <button class="seat" id="seatA2">A2</button>
                <button class="seat" id="seatA3">A3</button>
                <button class="seat" id="seatA4">A4</button>
                <button class="seat" id="seatA5">A5</button>
                <button class="seat" id="seatA6">A6</button>
                <button class="seat" id="seatA7">A7</button>
                <button class="seat" id="seatA8">A8</button>
                <button class="seat" id="seatA9">A9</button>
                <button class="seat" id="seatA10">A10</button>
                
                <!-- Row B -->
                <button class="seat" id="seatB1">B1</button>
                <button class="seat" id="seatB2">B2</button>
                <button class="seat" id="seatB3">B3</button>
                <button class="seat" id="seatB4">B4</button>
                <button class="seat" id="seatB5">B5</button>
                <button class="seat" id="seatB6">B6</button>
                <button class="seat" id="seatB7">B7</button>
                <button class="seat" id="seatB8">B8</button>
                <button class="seat" id="seatB9">B9</button>
                <button class="seat" id="seatB10">B10</button>
                
                <!-- Row C -->
                <button class="seat" id="seatC1">C1</button>
                <button class="seat" id="seatC2">C2</button>
                <button class="seat" id="seatC3">C3</button>
                <button class="seat" id="seatC4">C4</button>
                <button class="seat" id="seatC5">C5</button>
                <button class="seat" id="seatC6">C6</button>
                <button class="seat" id="seatC7">C7</button>
                <button class="seat" id="seatC8">C8</button>
                <button class="seat" id="seatC9">C9</button>
                <button class="seat" id="seatC10">C10</button>
                
                <!-- Row D -->
                <button class="seat" id="seatD1">D1</button>
                <button class="seat" id="seatD2">D2</button>
                <button class="seat" id="seatD3">D3</button>
                <button class="seat" id="seatD4">D4</button>
                <button class="seat" id="seatD5">D5</button>
                <button class="seat" id="seatD6">D6</button>
                <button class="seat" id="seatD7">D7</button>
                <button class="seat" id="seatD8">D8</button>
                <button class="seat" id="seatD9">D9</button>
                <button class="seat" id="seatD10">D10</button>
                
                <!-- Row E -->
                <button class="seat" id="seatE1">E1</button>
                <button class="seat" id="seatE2">E2</button>
                <button class="seat" id="seatE3">E3</button>
                <button class="seat" id="seatE4">E4</button>
                <button class="seat" id="seatE5">E5</button>
                <button class="seat" id="seatE6">E6</button>
                <button class="seat" id="seatE7">E7</button>
                <button class="seat" id="seatE8">E8</button>
                <button class="seat" id="seatE9">E9</button>
                <button class="seat" id="seatE10">E10</button>
                
                <!-- Row F -->
                <button class="seat" id="seatF1">F1</button>
                <button class="seat" id="seatF2">F2</button>
                <button class="seat" id="seatF3">F3</button>
                <button class="seat" id="seatF4">F4</button>
                <button class="seat" id="seatF5">F5</button>
                <button class="seat" id="seatF6">F6</button>
                <button class="seat" id="seatF7">F7</button>
                <button class="seat" id="seatF8">F8</button>
                <button class="seat" id="seatF9">F9</button>
                <button class="seat" id="seatF10">F10</button>
                
                <!-- Row G -->
                <button class="seat" id="seatG1">G1</button>
                <button class="seat" id="seatG2">G2</button>
                <button class="seat" id="seatG3">G3</button>
                <button class="seat" id="seatG4">G4</button>
                <button class="seat" id="seatG5">G5</button>
                <button class="seat" id="seatG6">G6</button>
                <button class="seat" id="seatG7">G7</button>
                <button class="seat" id="seatG8">G8</button>
                <button class="seat" id="seatG9">G9</button>
                <button class="seat" id="seatG10">G10</button>
                
                <!-- Row H -->
                <button class="seat" id="seatH1">H1</button>
                <button class="seat" id="seatH2">H2</button>
                <button class="seat" id="seatH3">H3</button>
                <button class="seat" id="seatH4">H4</button>
                <button class="seat" id="seatH5">H5</button>
                <button class="seat" id="seatH6">H6</button>
                <button class="seat" id="seatH7">H7</button>
                <button class="seat" id="seatH8">H8</button>
                <button class="seat" id="seatH9">H9</button>
                <button class="seat" id="seatH10">H10</button>
                
                <!-- Row I -->
                <button class="seat" id="seatI1">I1</button>
                <button class="seat" id="seatI2">I2</button>
                <button class="seat" id="seatI3">I3</button>
                <button class="seat" id="seatI4">I4</button>
                <button class="seat" id="seatI5">I5</button>
                <button class="seat" id="seatI6">I6</button>
                <button class="seat" id="seatI7">I7</button>
                <button class="seat" id="seatI8">I8</button>
                <button class="seat" id="seatI9">I9</button>
                <button class="seat" id="seatI10">I10</button>
                
                <!-- Row J -->
                <button class="seat" id="seatJ1">J1</button>
                <button class="seat" id="seatJ2">J2</button>
                <button class="seat" id="seatJ3">J3</button>
                <button class="seat" id="seatJ4">J4</button>
                <button class="seat" id="seatJ5">J5</button>
                <button class="seat" id="seatJ6">J6</button>
                <button class="seat" id="seatJ7">J7</button>
                <button class="seat" id="seatJ8">J8</button>
                <button class="seat" id="seatJ9">J9</button>
                <button class="seat" id="seatJ10">J10</button>
            </div>
        </div>
    
        <div class="payment-details">
            <h1 style="color: orange;">Payment Details</h1>
            <form id="paymentForm">
                <label for="userId">User ID No:</label>
                <input type="text" id="userId" name="userId" required>
    
                <label for="cardNumber">Card Number:</label>
                <input type="text" id="cardNumber" name="cardNumber" required>

                <label for="expiryYear">Expiry:</label>
                <input type="text" id="expiryYear" name="expiryYear" placeholder="MM/YY" required>
    
                <label for="cvv">CVV:</label>
                <input type="password" id="cvv" name="cvv" placeholder="CVV" required>
    
                <button type="submit">Submit Payment</button>
            </form>
        </div>
    </div>


    <div class="footer">
        <table class="footer-table">
            <tr>
                <th>GENERAL</th>
                <th>&nbsp;</th>
                <th>SOCIAL MEDIA</th>
            </tr>
            <tr>
                <td>
                    <ul>
                        <li><a href="">ABOUT US</a></li>
                        <li><a href="">FAQ'S</a></li>
                        <li><a href="">FEEDBACK</a></li>
                    </ul>
                </td>
                <td>
                    <ul>
                        <li><a href="">PRIVACY & POLICY</a></li>
                        <li><a href="">TERMS & CONDITIONS</a></li>
                        <li><a href="">TERMS OF USE</a></li>
                    </ul>
                </td>
                <td>
                    <div>
                        <a href="" class="fa fa-facebook"></a>
                        <a href="" class="fa fa-twitter"></a>
                        <a href="" class="fa fa-linkedin"></a>
                        <a href="" class="fa fa-instagram"></a>
                    </div>
                </td>
            </tr>
        </table>
    </div>

    <script>
        let urlParams = new URLSearchParams(window.location.search);
        let title = urlParams.get('title');
        let timeSlot = urlParams.get('timeSlot');
        let movieDate = urlParams.get('movieDate');
        let numOfSeats = urlParams.get('numSeats');
        let bookingId;
        //alert(`Title: ${title}\nMovie Date: ${movieDate}\nNumber of Seats: ${numOfSeats}`);

        document.addEventListener('DOMContentLoaded', function () {
            const prefix = "STC";
            let currentNumber = localStorage.getItem('currentBookingId') || 1; 
            bookingId = prefix + String(currentNumber).padStart(6, '0'); 

            alert(`Booking ID: ${bookingId}`);

            localStorage.setItem('currentBookingId', Number(currentNumber) + 1); 


            
            const apiEndpoint = `http://localhost:8080/api/bookingSeat/seat/${movieDate}/${timeSlot}`;

            fetch(apiEndpoint)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(seatNos => {
                    console.log("Retrieved seat numbers:", seatNos);

                    seatNos.forEach(seatNo => {
                        const seatButton = document.getElementById(`${seatNo}`);
                        if (seatButton) {
                            seatButton.style.backgroundColor = 'orange';  
                            seatButton.disabled = true;  
                        }
                    });

                })
                .catch(error => {
                    console.error("Error fetching seat numbers:", error);
                    alert("Error fetching seat data. Please try again.");
                });

        
        });

        

    </script>
</body>
</html>